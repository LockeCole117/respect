<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Respect::HashSchema
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (H)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Respect.html" title="Respect (module)">Respect</a></span></span>
     &raquo; 
    <span class="title">HashSchema</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Respect::HashSchema
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Schema.html" title="Respect::Schema (class)">Schema</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Schema.html" title="Respect::Schema (class)">Schema</a></span></li>
          
            <li class="next">Respect::HashSchema</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">Enumerable</dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/respect/hash_schema.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>A schema to specify the structure of a hash.</p>

<p>This schema defines the structure of a hash by listing the expected
property name and they associated schema.</p>

<p>Property can be define by using a symbol, a string or a regular expression.
In the later case, the associated schema will be used to validate the value
of all the properties matching the regular expression. You can get the list
of all pattern properties using the <span class='object_link'><a href="#pattern_properties-instance_method" title="Respect::HashSchema#pattern_properties (method)">#pattern_properties</a></span> method.</p>

<p>You can specify optional property by either setting the "required" option
to false or y setting a non nil default value. You can get the list of all
optional properties using the <span class='object_link'><a href="#optional_properties-instance_method" title="Respect::HashSchema#optional_properties (method)">#optional_properties</a></span> method.</p>

<p>Access to the object's value being validated is done using either string
key or symbol key. In other word <tt>{ i: &quot;42&quot; }</tt> and <tt>{ &quot;i&quot; =&amp;gt; &quot;42&quot; }</tt> are
the same object for the <span class='object_link'><a href="#validate-instance_method" title="Respect::HashSchema#validate (method)">#validate</a></span> method. The object passed is left
untouched. The sanitized object is a hash with indifferent access. Note
that when an object is sanitized in-place, its original keys are kept (see
<span class='object_link'><a href="../Respect.html#sanitize_object%21-class_method" title="Respect.sanitize_object! (method)">sanitize_object!</a></span>). Only validated keys are included in the
sanitized object.</p>

<p>You can pass several options when creating an <span class='object_link'><a href="" title="Respect::HashSchema (class)">HashSchema</a></span>:</p>
<table class="rdoc-list"><tr><td class="rdoc-term"><p>strict</p></td>
<td>
<p>if set to <tt>true</tt> the hash must not have any extra properties to be
validated. (<tt>false</tt> by default)</p>
</td></tr></table>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#properties-instance_method" title="#properties (instance method)">- (Object) <strong>properties</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the set of properties of this schema index by their name.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="Schema.html" title="Respect::Schema (class)">Schema</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Schema.html#last_error-instance_method" title="Respect::Schema#last_error (method)">#last_error</a></span>, <span class='object_link'><a href="Schema.html#options-instance_method" title="Respect::Schema#options (method)">#options</a></span>, <span class='object_link'><a href="Schema.html#sanitized_object-instance_method" title="Respect::Schema#sanitized_object (method)">#sanitized_object</a></span></p>


  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#default_options-class_method" title="default_options (class method)">+ (Object) <strong>default_options</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Overwritten method.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%3D%3D-instance_method" title="#== (instance method)">- (Object) <strong>==</strong>(other) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%5B%5D-instance_method" title="#[] (instance method)">- (Object) <strong>[]</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the schema for the given property <tt>name</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%5B%5D%3D-instance_method" title="#[]= (instance method)">- (Object) <strong>[]=</strong>(name, schema) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set the given <tt>schema</tt> for the given property <tt>name</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#documented_properties-instance_method" title="#documented_properties (instance method)">- (Object) <strong>documented_properties</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return all the properties with a non-false documentation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each-instance_method" title="#each (instance method)">- (Object) <strong>each</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>FIXME(Nicolas Despres): Add a test for me.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eval-instance_method" title="#eval (instance method)">- (Object) <strong>eval</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Evaluate the given block as a hash schema definition (i.e. in the context
of <span class='object_link'><a href="HashDef.html" title="Respect::HashDef (class)">HashDef</a></span>) and merge the result with this hash schema.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_property%3F-instance_method" title="#has_property? (instance method)">- (Boolean) <strong>has_property?</strong>(property_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return whether <tt>property_name</tt> is defined in this hash schema.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (HashSchema) <strong>initialize</strong>(options = {}) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of HashSchema.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize_copy-instance_method" title="#initialize_copy (instance method)">- (Object) <strong>initialize_copy</strong>(other) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#merge-instance_method" title="#merge (instance method)">- (Object) <strong>merge</strong>(hash_schema) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Merge the given <tt>hash_schema</tt> with this object schema.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#merge%21-instance_method" title="#merge! (instance method)">- (Object) <strong>merge!</strong>(hash_schema) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>In-place version of <span class='object_link'><a href="#merge-instance_method" title="Respect::HashSchema#merge (method)">#merge</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#optional_properties-instance_method" title="#optional_properties (instance method)">- (Object) <strong>optional_properties</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the optional properties (e.g. those that are not required).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pattern_properties-instance_method" title="#pattern_properties (instance method)">- (Object) <strong>pattern_properties</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return all the properties identified by a regular expression.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate-instance_method" title="#validate (instance method)">- (Object) <strong>validate</strong>(object) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Overwritten method.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Schema.html" title="Respect::Schema (class)">Schema</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Schema.html#allow_nil%3F-instance_method" title="Respect::Schema#allow_nil? (method)">#allow_nil?</a></span>, <span class='object_link'><a href="Schema.html#def_class-class_method" title="Respect::Schema.def_class (method)">def_class</a></span>, <span class='object_link'><a href="Schema.html#def_class_name-class_method" title="Respect::Schema.def_class_name (method)">def_class_name</a></span>, <span class='object_link'><a href="Schema.html#default-instance_method" title="Respect::Schema#default (method)">#default</a></span>, <span class='object_link'><a href="Schema.html#define-class_method" title="Respect::Schema.define (method)">define</a></span>, <span class='object_link'><a href="Schema.html#documentation-instance_method" title="Respect::Schema#documentation (method)">#documentation</a></span>, <span class='object_link'><a href="Schema.html#documented%3F-instance_method" title="Respect::Schema#documented? (method)">#documented?</a></span>, <span class='object_link'><a href="Schema.html#has_default%3F-instance_method" title="Respect::Schema#has_default? (method)">#has_default?</a></span>, <span class='object_link'><a href="Schema.html#inspect-instance_method" title="Respect::Schema#inspect (method)">#inspect</a></span>, <span class='object_link'><a href="Schema.html#non_default_options-instance_method" title="Respect::Schema#non_default_options (method)">#non_default_options</a></span>, <span class='object_link'><a href="Schema.html#optional%3F-instance_method" title="Respect::Schema#optional? (method)">#optional?</a></span>, <span class='object_link'><a href="Schema.html#required%3F-instance_method" title="Respect::Schema#required? (method)">#required?</a></span>, <span class='object_link'><a href="Schema.html#sanitize%21-instance_method" title="Respect::Schema#sanitize! (method)">#sanitize!</a></span>, <span class='object_link'><a href="Schema.html#sanitize_object%21-instance_method" title="Respect::Schema#sanitize_object! (method)">#sanitize_object!</a></span>, <span class='object_link'><a href="Schema.html#statement_name-class_method" title="Respect::Schema.statement_name (method)">statement_name</a></span>, <span class='object_link'><a href="Schema.html#to_h-instance_method" title="Respect::Schema#to_h (method)">#to_h</a></span>, <span class='object_link'><a href="Schema.html#to_json-instance_method" title="Respect::Schema#to_json (method)">#to_json</a></span>, <span class='object_link'><a href="Schema.html#to_s-instance_method" title="Respect::Schema#to_s (method)">#to_s</a></span>, <span class='object_link'><a href="Schema.html#validate%21-instance_method" title="Respect::Schema#validate! (method)">#validate!</a></span>, <span class='object_link'><a href="Schema.html#validate%3F-instance_method" title="Respect::Schema#validate? (method)">#validate?</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="DocHelper.html" title="Respect::DocHelper (module)">DocHelper</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="DocHelper.html#description-instance_method" title="Respect::DocHelper#description (method)">#description</a></span>, <span class='object_link'><a href="DocHelper.html#title-instance_method" title="Respect::DocHelper#title (method)">#title</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Respect::HashSchema (class)">HashSchema</a></span></tt>) <strong>initialize</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A new instance of HashSchema</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 44</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_default_options'>default_options</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='ivar'>@properties</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="properties-instance_method">
  
    - (<tt>Object</tt>) <strong>properties</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the set of properties of this schema index by their name.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 74</span>

<span class='kw'>def</span> <span class='id identifier rubyid_properties'>properties</span>
  <span class='ivar'>@properties</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="default_options-class_method">
  
    + (<tt>Object</tt>) <strong>default_options</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Overwritten method. See Schema::default_options</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37
38
39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 35</span>

<span class='kw'>def</span> <span class='id identifier rubyid_default_options'>default_options</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='lbrace'>{</span>
      <span class='label'>strict:</span> <span class='kw'>false</span><span class='comma'>,</span>
    <span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="==-instance_method">
  
    - (<tt>Object</tt>) <strong>==</strong>(other) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


209
210
211</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 209</span>

<span class='kw'>def</span> <span class='op'>==</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>super</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@properties</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="[]-instance_method">
  
    - (<tt>Object</tt>) <strong>[]</strong>(name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the schema for the given property <tt>name</tt>.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 55</span>

<span class='kw'>def</span> <span class='op'>[]</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='ivar'>@properties</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="[]=-instance_method">
  
    - (<tt>Object</tt>) <strong>[]=</strong>(name, schema) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set the given <tt>schema</tt> for the given property <tt>name</tt>. A name
can be a Symbol, a String or a Regexp.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63
64
65
66
67
68
69
70
71</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 61</span>

<span class='kw'>def</span> <span class='op'>[]=</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_name'>name</span>
  <span class='kw'>when</span> <span class='const'>Symbol</span><span class='comma'>,</span> <span class='const'>String</span><span class='comma'>,</span> <span class='const'>Regexp</span>
    <span class='kw'>if</span> <span class='ivar'>@properties</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>InvalidSchemaError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>property '</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>' already defined</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='ivar'>@properties</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_schema'>schema</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>InvalidSchemaError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unsupported property name type </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="documented_properties-instance_method">
  
    - (<tt>Object</tt>) <strong>documented_properties</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return all the properties with a non-false documentation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


205
206
207</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 205</span>

<span class='kw'>def</span> <span class='id identifier rubyid_documented_properties'>documented_properties</span>
  <span class='ivar'>@properties</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='op'>|</span> <span class='id identifier rubyid_schema'>schema</span><span class='period'>.</span><span class='id identifier rubyid_documented?'>documented?</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each-instance_method">
  
    - (<tt>Object</tt>) <strong>each</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>FIXME(Nicolas Despres): Add a test for me.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


214
215
216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 214</span>

<span class='kw'>def</span> <span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@properties</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eval-instance_method">
  
    - (<tt>Object</tt>) <strong>eval</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Evaluate the given block as a hash schema definition (i.e. in the context
of <span class='object_link'><a href="HashDef.html" title="Respect::HashDef (class)">Respect::HashDef</a></span>) and merge the result with this hash schema. This is
a way to "re-open" this hash schema definition to add some more.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 200</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eval'>eval</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='const'>HashSchema</span><span class='period'>.</span><span class='id identifier rubyid_define'>define</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_property?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>has_property?</strong>(property_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return whether <tt>property_name</tt> is defined in this hash schema.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_property?'>has_property?</span><span class='lparen'>(</span><span class='id identifier rubyid_property_name'>property_name</span><span class='rparen'>)</span>
  <span class='ivar'>@properties</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_property_name'>property_name</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialize_copy-instance_method">
  
    - (<tt>Object</tt>) <strong>initialize_copy</strong>(other) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


49
50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 49</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_copy'>initialize_copy</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>super</span>
  <span class='ivar'>@properties</span> <span class='op'>=</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="merge-instance_method">
  
    - (<tt>Object</tt>) <strong>merge</strong>(hash_schema) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Merge the given <tt>hash_schema</tt> with this object schema. It works like
<tt>Hash.merge</tt>.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


188
189
190</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 188</span>

<span class='kw'>def</span> <span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_hash_schema'>hash_schema</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_hash_schema'>hash_schema</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="merge!-instance_method">
  
    - (<tt>Object</tt>) <strong>merge!</strong>(hash_schema) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>In-place version of <span class='object_link'><a href="#merge-instance_method" title="Respect::HashSchema#merge (method)">#merge</a></span>. This schema is returned.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 180</span>

<span class='kw'>def</span> <span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_hash_schema'>hash_schema</span><span class='rparen'>)</span>
  <span class='ivar'>@options</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_hash_schema'>hash_schema</span><span class='period'>.</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='ivar'>@properties</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_hash_schema'>hash_schema</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="optional_properties-instance_method">
  
    - (<tt>Object</tt>) <strong>optional_properties</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return the optional properties (e.g. those that are not required).</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


170
171
172</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 170</span>

<span class='kw'>def</span> <span class='id identifier rubyid_optional_properties'>optional_properties</span>
  <span class='ivar'>@properties</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='op'>|</span> <span class='id identifier rubyid_schema'>schema</span><span class='period'>.</span><span class='id identifier rubyid_optional?'>optional?</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pattern_properties-instance_method">
  
    - (<tt>Object</tt>) <strong>pattern_properties</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return all the properties identified by a regular expression.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


175
176
177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 175</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pattern_properties'>pattern_properties</span>
  <span class='ivar'>@properties</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='op'>|</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Regexp</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate-instance_method">
  
    - (<tt>Object</tt>) <strong>validate</strong>(object) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Overwritten method. See <span class='object_link'><a href="Schema.html#validate-instance_method" title="Respect::Schema#validate (method)">Schema#validate</a></span>.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/respect/hash_schema.rb', line 77</span>

<span class='kw'>def</span> <span class='id identifier rubyid_validate'>validate</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
  <span class='comment'># Handle nil case.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_allow_nil?'>allow_nil?</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sanitized_object'>sanitized_object</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>return</span> <span class='kw'>true</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ValidationError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>object is nil but this </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='rbrace'>}</span><span class='tstring_content'> does not allow nil</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='comment'># Validate object format.
</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ValidationError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>object is not a hash but a </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_sanitized_object'>sanitized_object</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_with_indifferent_access'>with_indifferent_access</span>
  <span class='comment'># Validate expected properties.
</span>  <span class='ivar'>@properties</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_name'>name</span>
    <span class='kw'>when</span> <span class='const'>Symbol</span>
      <span class='id identifier rubyid_validate_property_with_options'>validate_property_with_options</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='comma'>,</span> <span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='id identifier rubyid_sanitized_object'>sanitized_object</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'>String</span>
      <span class='id identifier rubyid_validate_property_with_options'>validate_property_with_options</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='comma'>,</span> <span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='id identifier rubyid_sanitized_object'>sanitized_object</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'>Regexp</span>
      <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_prop'>prop</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='op'>|</span> <span class='id identifier rubyid_prop'>prop</span> <span class='op'>=~</span> <span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_prop'>prop</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
        <span class='id identifier rubyid_validate_property'>validate_property</span><span class='lparen'>(</span><span class='id identifier rubyid_prop'>prop</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='comma'>,</span> <span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='id identifier rubyid_sanitized_object'>sanitized_object</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:strict</span><span class='rbracket'>]</span>
    <span class='comment'># Check whether there are extra properties.
</span>    <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='op'>|</span>
      <span class='kw'>unless</span> <span class='id identifier rubyid_sanitized_object'>sanitized_object</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span> <span class='id identifier rubyid_name'>name</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ValidationError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unexpected key `</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sanitized_object'>sanitized_object</span> <span class='op'>=</span> <span class='id identifier rubyid_sanitized_object'>sanitized_object</span>
  <span class='kw'>true</span>
<span class='kw'>rescue</span> <span class='const'>ValidationError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='comment'># Reset sanitized object.
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sanitized_object'>sanitized_object</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_e'>e</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sat Jun  1 16:33:05 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-1.9.3).
</div>

  </body>
</html>